<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Meta tags -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="mobile-web-app-capable" content="yes">

		<!-- style sheets -->

		<link rel="stylesheet" type="text/css">
		<style type="text/css">
				body {padding:0; margin:0; font-family:arial; background-color:#f5f4f0; color:#555;}
div {box-sizing:border-box;}
ul {list-style-type: none; padding:0; margin:0;}
a {color:#026dc5; text-decoration: none;}

.tools {padding:8px 8px; display:flex; flex-direction: row;}
		.tools li {flex-grow:1; }
		.tools li {display:block; font-size:13px; background-color:#fff; border:solid 1px #026dc5; padding:4px 8px; border-radius:2px;}

		</style>

	</head>

	<body>

		<div id="header-wrapper"></div>
		<ul class="tools">
			<li style=" margin-right:4px;"><label style="font-size:11px; font-weight:normal; display:block; padding-bottom:2px">Open</label><a href="" >Filters</a></li>
			
			<li style="position:relative; background-color:#fff; border:solid 1px #026dc5; font-weight:bold; padding:4px 4px; border-radius:2px; margin-right:4px; flex-grow:1;">
				
				<label style="font-size:11px; font-weight:normal; display:block; padding:0 4px">Sort by:</label>
				<select style="font-size:13px; font-family:arial; padding:0; color:#026dc5; background: transparent; border:none; width:100%; outline:none;">
					<option>Our favourites</option>
					<option>Stars (high to low)</option>
					<option>Stars (low to high)</option>
					<option>Distance to city center</option>
					<option>Guest rating</option>
					<option>Price (high to low)</option>
					<option>Price (low to high)</option>
				</select>
				
			</li>
			<li ><label style="font-size:11px; font-weight:normal; display:block; padding-bottom:2px">View on</label><a href="#" >Map</a></li>
		</ul>
		

		<div id="hotel-list"></div>

		<script id="hotel-card-template" type="text/x-handlebars-template">
 			{{#each hotels}}
 				<div class="hotel-card">
 					<div class="thumbnail">
 						<img src="{{thumbnailUrl imageUrl}}" />
 					</div>
 					<div class="details">
 						<div class="name"><a href="#">{{hotelName}}</a></div>
 						<div class="neighbourhood">{{neighbourhood location}}</div>
 						<div class="proximity-base">{{distanceFromBaseLandmark}} to city center</div>
 					</div>
 					<div class="rating">
 						<div class="guestRating">
 							<span class="qual">{{qualitativeBadgeText}}</span> 
 							<span class="score">{{guestReviewRating}}</span> / 5 
 							<span class="numReviews">{{numberOfGuestReviews}} reviews</span>
 						</div>
       	 				<div class="taGuestReview">
       	 					<img class="owl" src="i/ta-owl.png" /><img class="circles" src="i/ta-circles.png" /> 
       	 					<span class="numReviews">100 reviews</span>
       	 				</div>
 					</div>
 					<div class="price">
 						{{#if promoPriceDetails}}
										{{#if promoPriceDescription.length}}
       	 								<div class="special-deal">
       	 									<span class="promo-price-description">{{promoPriceDescription}}</span>
       	 									<span class="strikethrough">{{avgPrice}}</span> 
       	 									<span class="total">{{promoPriceDetails.prefix}}{{promoPriceDetails.formattedValue}}</span>
       	 								</div>
       	 							{{else}}
       	 								<div class="standard">{{promoPriceDetails.prefix}}{{promoPriceDetails.formattedValue}}</div>
       	 							{{/if}}
       	 				
       	 						{{else}}
       	 							<div class="standard">{{avgPrice}}</div>
       	 						{{/if}}
       	 						<span class="summary">price for 1 night including taxes and fees</span>
 					</div>
 				</div>
 			{{/each}}
    	</script>	

    	<style type="text/css">
    		.hotel-card {background-color: #fff; min-height:120px; margin-bottom:4px; border-bottom: solid 1px #e5e3db; border-top: solid 1px #e5e3db; position:relative;}
    		.hotel-card .thumbnail {position:absolute; top:8px; left:8px; bottom:8px; width:25%; text-align: center; overflow: hidden;}
			.hotel-card .thumbnail img { position: relative; left: 100%; margin-left: -200%; height:100%;}
			.hotel-card .details, .hotel-card .price, .hotel-card .rating {margin-left:25%; box-sizing:border-box; padding-left:16px;}
			.hotel-card .details {margin-top:8px;}
			.hotel-card .name {font-size:14px; line-height: 18px;}
			.hotel-card .neighbourhood {font-size:12px; line-height: 16px}
			.hotel-card .proximity-base {font-size:12px; line-height: 16px}

			.hotel-card .rating {margin-top:8px;}
			.hotel-card .rating .guestRating {font-size: 14px; line-height: 16px; font-weight:bold;}
			.hotel-card .rating .guestRating .numReviews {font-size: 11px; line-height: 13px; color:#999; font-weight: normal; display:inline-block; vertical-align: bottom; margin-left:4px;}
			.hotel-card .rating .taGuestReview {}
			.hotel-card .rating .taGuestReview .owl {height:13px; display:inline-block;}
			.hotel-card .rating .taGuestReview .numReviews {font-size:11px; line-height: 15px; color:#999; display:inline-block;}

			.hotel-card .price {text-align:right; margin-top:8px; padding:0 12px 4px 0;}
			.promo-price-description {display:block; font-size:12px; line-height:16px; font-weight:bold; color:#d41200;}
			.strikethrough {font-size: 14px; text-decoration: line-through;}
			.total {font-size:20px; color:#d41200; font-weight:bold;}
			.summary {font-size:11px; color:#999;}
			.standard {font-size:20px; font-weight:bold;}
    	</style>

		<!-- Scripts -->
		<!-- JQuery Google CDN -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="https://use.fontawesome.com/37c289f6f2.js"></script>
		<script src="../handlebars.js"></script>

		<script type="text/javascript">

			// run things on page load
			$(function(){
      			
				$( "#header-wrapper" ).load( "../components/c-header-new.html" );
				$.getJSON( "../ny-json.js", function(data){
					console.log(data);
					displayHotels(data);
				});
			});

			var displayHotels = function(data){
				// get hotel data
				var hotels = data.result;
				console.log(hotels);
				
				// attach to handle bar template
        		var source   = $("#hotel-card-template").html();
  				var template = Handlebars.compile(source);
  				$("#hotel-list").html(template(hotels));
			}

			Handlebars.registerHelper("thumbnailUrl", function(imageUrl){
				var url = imageUrl.replace("_b.jpg", "_l.jpg");
				return url;
			});

			Handlebars.registerHelper("neighbourhood", function(location){
				var res = location.split("/");
				//var url = imageUrl.replace("_b.jpg", "_l.jpg");
				return res[0];
			});

		</script>
	</body>
</html>